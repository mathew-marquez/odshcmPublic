SELECT 				
	A.POSITION_NBR,			
	A.REPORTS_TO AS REPORTS_POSN_NBR,			
(CASE 				
	WHEN A.REPORTS_TO = '40048214' THEN '10052493'			
	WHEN A.REPORTS_TO = '40048872' THEN '10051640'			
	WHEN A.REPORTS_TO = '40064684' THEN '10052327'			
	WHEN A.REPORTS_TO = '40058514' THEN '10066199'			
	WHEN A.REPORTS_TO = '40106787' THEN '10097664'			
END) AS MANAGER_ID,				
(CASE 				
	WHEN A.REPORTS_TO = '40048214' THEN 'Alan Fogelman'			
	WHEN A.REPORTS_TO = '40048872' THEN 'Allison Baird-James'			
	WHEN A.REPORTS_TO = '40064684' THEN 'Jordan Senko'			
	WHEN A.REPORTS_TO = '40058514' THEN 'Peter Whybrow'			
	WHEN A.REPORTS_TO = '40106787' THEN 'Adam Fronczek'			
END) AS MANAGER_NAME,				
	LEFT(A.DEPTID,4) AS DEPTID,			
	D.DESCR,
	A.POSN_STATUS
FROM 				
	PS_POSITION_DATA A			
	LEFT JOIN PS_DEPT_TBL D ON D.DEPTID = A.DEPTID			
	LEFT JOIN PS_ACTN_REASON_TBL E ON E.ACTION_REASON = A.ACTION_REASON			
WHERE 				
		D.DML_IND <> 'D'		
	AND A.DML_IND <> 'D'			
	AND E.DML_IND <> 'D'			
	--AND B.HR_STATUS = 'A'			
	--AND A.ACTION_REASON NOT IN ('INA', 'IN1', 'IN2' , 'IN3')			
	AND A.POSITION_NBR NOT IN ('40038740','40043890','40046786','40061950','40041802','40054414','40052165','40046610','40050704')
	AND A.MAX_HEAD_COUNT = 1			
	AND E.ACTION = 'POS'			
	AND D.EFFDT =			
			(SELECT MAX(D2.EFFDT)	
			FROM PS_DEPT_TBL D2	
			WHERE D2.DEPTID = D.DEPTID	
			AND D2.DML_IND <> 'D'	
			AND D2.EFFDT <= GETDATE())	
	AND A.EFFDT =			
			(SELECT MAX(A2.EFFDT)	
			FROM PS_POSITION_DATA A2	
			WHERE A2.POSITION_NBR = A.POSITION_NBR	
			AND A2.DML_IND <> 'D'	
			AND A2.EFFDT <= GETDATE())	
	AND E.EFFDT =			
			(SELECT MAX(E2.EFFDT)	
			FROM PS_ACTN_REASON_TBL E2	
			WHERE E2.ACTION_REASON = E.ACTION_REASON	
			AND E2.ACTION = 'POS'	
			AND E2.DML_IND <> 'D'	
			AND E2.EFFDT <= GETDATE())	
	AND (CASE 			
		WHEN A.REPORTS_TO = '40048214' THEN 'Alan Fogelman'		
		WHEN A.REPORTS_TO = '40048872' THEN 'Allison Baird-James'		
		WHEN A.REPORTS_TO = '40064684' THEN 'Jordan Senko'		
		WHEN A.REPORTS_TO = '40058514' THEN 'Peter Whybrow'		
		WHEN A.REPORTS_TO = '40106787' THEN 'Adam Fronczek'		
	END) IS NOT NULL			
GROUP BY				
	A.POSITION_NBR,			
	A.ACTION_REASON,			
	E.DESCR,			
	A.REPORTS_TO,			
	A.DEPTID,			
	D.DESCR,
	A.POSN_STATUS		
;